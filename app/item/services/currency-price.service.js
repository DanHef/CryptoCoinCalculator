"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var CurrencyPrice_1 = require("../CurrencyPrice");
var nativescript_secure_storage_1 = require("nativescript-secure-storage");
var CurrencyPriceService = (function () {
    function CurrencyPriceService() {
        this.currencyPrices = [];
        this.secureStorage = new nativescript_secure_storage_1.SecureStorage();
        this.currencyPricesChanged = new core_1.EventEmitter();
    }
    CurrencyPriceService.prototype.addCurrencyPrice = function (currencyPrice) {
        this.currencyPrices.push(currencyPrice);
    };
    CurrencyPriceService.prototype.createCurrencyPrice = function (codeFrom, codeTo, description, platform) {
        var newCurrencyPrice = new CurrencyPrice_1.CurrencyPrice(codeFrom, codeTo, platform, description);
        this.currencyPrices.push(newCurrencyPrice);
        this.currencyPricesChanged.emit({
            data: null,
            message: null,
            notification: null
        });
        return newCurrencyPrice;
    };
    CurrencyPriceService.prototype.deleteCurrencyPrice = function (currencyPrice) {
        for (var i = 0; i < this.currencyPrices.length; i++) {
            var currentCurrencyPrice = this.currencyPrices[i];
            if (currentCurrencyPrice.platform === currencyPrice.platform &&
                currentCurrencyPrice.currencyCodeFrom === currencyPrice.currencyCodeFrom &&
                currentCurrencyPrice.currencyCodeTo === currencyPrice.currencyCodeTo) {
                this.currencyPrices.splice(i, 1);
                this.currencyPricesChanged.emit({
                    data: null,
                    message: null,
                    notification: null
                });
            }
        }
    };
    CurrencyPriceService.prototype.getAllCurrencyPrices = function (platform) {
        var currencyPrices;
        if (platform) {
            currencyPrices = [];
            for (var i = 0; i < this.currencyPrices.length; i++) {
                if (this.currencyPrices[i].platform === platform) {
                    currencyPrices.push(this.currencyPrices[i]);
                }
            }
        }
        else {
            currencyPrices = this.currencyPrices;
        }
        return currencyPrices;
    };
    CurrencyPriceService.prototype.getCurrencyPriceAmount = function (codeFrom, codeTo, platform) {
        for (var i = 0; i < this.currencyPrices.length; i++) {
            if (this.currencyPrices[i].currencyCodeFrom === codeFrom &&
                this.currencyPrices[i].currencyCodeTo === codeTo &&
                this.currencyPrices[i].platform === platform) {
                return this.currencyPrices[i].price;
            }
        }
    };
    CurrencyPriceService.prototype.getCurrencyPrice = function (codeFrom, codeTo, platform) {
        for (var i = 0; i < this.currencyPrices.length; i++) {
            if ((this.currencyPrices[i].currencyCodeFrom === codeFrom &&
                this.currencyPrices[i].currencyCodeTo === codeTo) ||
                (this.currencyPrices[i].currencyCodeFrom === codeTo &&
                    this.currencyPrices[i].currencyCodeTo === codeFrom) &&
                    this.currencyPrices[i].platform === platform) {
                return this.currencyPrices[i];
            }
        }
    };
    CurrencyPriceService.prototype.saveCurrencyPrices = function () {
        this.secureStorage.setSync({
            key: "cryptoCoinCalcPriceInformationData",
            value: JSON.stringify(this.currencyPrices)
        });
    };
    CurrencyPriceService.prototype.loadCurrencyPrices = function () {
        var storedPriceInformationString = this.secureStorage.getSync({
            key: "cryptoCoinCalcPriceInformationData",
        });
        if (storedPriceInformationString) {
            var storedPriceInformations = JSON.parse(storedPriceInformationString);
            for (var i = 0; i < storedPriceInformations.length; i++) {
                var storedPriceInformation = storedPriceInformations[i];
                this.createCurrencyPrice(storedPriceInformation.currencyCodeFrom, storedPriceInformation.currencyCodeTo, storedPriceInformation.currencyPriceDescription, storedPriceInformation.platform);
            }
        }
    };
    CurrencyPriceService = __decorate([
        core_1.Injectable()
    ], CurrencyPriceService);
    return CurrencyPriceService;
}());
exports.CurrencyPriceService = CurrencyPriceService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VycmVuY3ktcHJpY2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImN1cnJlbmN5LXByaWNlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzQ0FBeUQ7QUFFekQsa0RBQWlEO0FBQ2pELDJFQUE0RDtBQUc1RDtJQURBO1FBRUksbUJBQWMsR0FBeUIsRUFBRSxDQUFDO1FBQ2xDLGtCQUFhLEdBQWtCLElBQUksMkNBQWEsRUFBRSxDQUFDO1FBQ3BELDBCQUFxQixHQUFHLElBQUksbUJBQVksRUFBVSxDQUFDO0lBMEc5RCxDQUFDO0lBeEdHLCtDQUFnQixHQUFoQixVQUFpQixhQUFhO1FBQzFCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFHRCxrREFBbUIsR0FBbkIsVUFBb0IsUUFBZ0IsRUFBRSxNQUFjLEVBQUUsV0FBVyxFQUFFLFFBQVE7UUFDdkUsSUFBSSxnQkFBZ0IsR0FBRyxJQUFJLDZCQUFhLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFFbEYsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUUzQyxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDO1lBQzVCLElBQUksRUFBRSxJQUFJO1lBQ1YsT0FBTyxFQUFFLElBQUk7WUFDYixZQUFZLEVBQUUsSUFBSTtTQUNyQixDQUFDLENBQUM7UUFFSCxNQUFNLENBQUMsZ0JBQWdCLENBQUM7SUFDNUIsQ0FBQztJQUVELGtEQUFtQixHQUFuQixVQUFvQixhQUE0QjtRQUM1QyxHQUFHLENBQUEsQ0FBQyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDN0MsSUFBSSxvQkFBb0IsR0FBRyxJQUFJ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NkdDO0FBN0dZLG9EQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEV2ZW50RW1pdHRlciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmltcG9ydCB7IEN1cnJlbmN5UHJpY2UgfSBmcm9tIFwiLi4vQ3VycmVuY3lQcmljZVwiO1xuaW1wb3J0IHsgU2VjdXJlU3RvcmFnZSB9IGZyb20gXCJuYXRpdmVzY3JpcHQtc2VjdXJlLXN0b3JhZ2VcIjtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEN1cnJlbmN5UHJpY2VTZXJ2aWNlIHtcbiAgICBjdXJyZW5jeVByaWNlczogQXJyYXk8Q3VycmVuY3lQcmljZT4gPSBbXTtcbiAgICBwcml2YXRlIHNlY3VyZVN0b3JhZ2U6IFNlY3VyZVN0b3JhZ2UgPSBuZXcgU2VjdXJlU3RvcmFnZSgpO1xuICAgIHB1YmxpYyBjdXJyZW5jeVByaWNlc0NoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPE9iamVjdD4oKTtcblxuICAgIGFkZEN1cnJlbmN5UHJpY2UoY3VycmVuY3lQcmljZSkge1xuICAgICAgICB0aGlzLmN1cnJlbmN5UHJpY2VzLnB1c2goY3VycmVuY3lQcmljZSk7XG4gICAgfVxuXG5cbiAgICBjcmVhdGVDdXJyZW5jeVByaWNlKGNvZGVGcm9tOiBzdHJpbmcsIGNvZGVUbzogc3RyaW5nLCBkZXNjcmlwdGlvbiwgcGxhdGZvcm0pOiBDdXJyZW5jeVByaWNlIHtcbiAgICAgICAgbGV0IG5ld0N1cnJlbmN5UHJpY2UgPSBuZXcgQ3VycmVuY3lQcmljZShjb2RlRnJvbSwgY29kZVRvLCBwbGF0Zm9ybSwgZGVzY3JpcHRpb24pO1xuXG4gICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXMucHVzaChuZXdDdXJyZW5jeVByaWNlKTtcblxuICAgICAgICB0aGlzLmN1cnJlbmN5UHJpY2VzQ2hhbmdlZC5lbWl0KHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsIFxuICAgICAgICAgICAgbWVzc2FnZTogbnVsbCwgXG4gICAgICAgICAgICBub3RpZmljYXRpb246IG51bGxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIG5ld0N1cnJlbmN5UHJpY2U7XG4gICAgfVxuXG4gICAgZGVsZXRlQ3VycmVuY3lQcmljZShjdXJyZW5jeVByaWNlOiBDdXJyZW5jeVByaWNlKSB7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY3VycmVuY3lQcmljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Q3VycmVuY3lQcmljZSA9IHRoaXMuY3VycmVuY3lQcmljZXNbaV07XG4gICAgICAgICAgICBpZihjdXJyZW50Q3VycmVuY3lQcmljZS5wbGF0Zm9ybSA9PT0gY3VycmVuY3lQcmljZS5wbGF0Zm9ybSAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRDdXJyZW5jeVByaWNlLmN1cnJlbmN5Q29kZUZyb20gPT09IGN1cnJlbmN5UHJpY2UuY3VycmVuY3lDb2RlRnJvbSAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRDdXJyZW5jeVByaWNlLmN1cnJlbmN5Q29kZVRvID09PSBjdXJyZW5jeVByaWNlLmN1cnJlbmN5Q29kZVRvKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXMuc3BsaWNlKGksMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXNDaGFuZ2VkLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbnVsbCwgXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbjogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgZ2V0QWxsQ3VycmVuY3lQcmljZXMocGxhdGZvcm0/OiBzdHJpbmcpOiBBcnJheTxDdXJyZW5jeVByaWNlPiB7XG4gICAgICAgIGxldCBjdXJyZW5jeVByaWNlcztcblxuICAgICAgICBpZiAocGxhdGZvcm0pIHtcbiAgICAgICAgICAgIGN1cnJlbmN5UHJpY2VzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY3VycmVuY3lQcmljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW5jeVByaWNlc1tpXS5wbGF0Zm9ybSA9PT0gcGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lQcmljZXMucHVzaCh0aGlzLmN1cnJlbmN5UHJpY2VzW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdXJyZW5jeVByaWNlcyA9IHRoaXMuY3VycmVuY3lQcmljZXM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY3VycmVuY3lQcmljZXM7XG4gICAgfVxuXG5cbiAgICBnZXRDdXJyZW5jeVByaWNlQW1vdW50KGNvZGVGcm9tOiBzdHJpbmcsIGNvZGVUbzogc3RyaW5nLCBwbGF0Zm9ybTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmN1cnJlbmN5UHJpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW5jeVByaWNlc1tpXS5jdXJyZW5jeUNvZGVGcm9tID09PSBjb2RlRnJvbSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXNbaV0uY3VycmVuY3lDb2RlVG8gPT09IGNvZGVUbyAmJlxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXNbaV0ucGxhdGZvcm0gPT09IHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVuY3lQcmljZXNbaV0ucHJpY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGdldEN1cnJlbmN5UHJpY2UoY29kZUZyb206IHN0cmluZywgY29kZVRvOiBzdHJpbmcsIHBsYXRmb3JtOiBzdHJpbmcpOiBDdXJyZW5jeVByaWNlIHtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8dGhpcy5jdXJyZW5jeVByaWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYoKHRoaXMuY3VycmVuY3lQcmljZXNbaV0uY3VycmVuY3lDb2RlRnJvbSA9PT0gY29kZUZyb20gJiZcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbmN5UHJpY2VzW2ldLmN1cnJlbmN5Q29kZVRvID09PSBjb2RlVG8pIHx8IFxuICAgICAgICAgICAgICAgICh0aGlzLmN1cnJlbmN5UHJpY2VzW2ldLmN1cnJlbmN5Q29kZUZyb20gPT09IGNvZGVUbyAmJlxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXNbaV0uY3VycmVuY3lDb2RlVG8gPT09IGNvZGVGcm9tKSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lQcmljZXNbaV0ucGxhdGZvcm0gPT09IHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbmN5UHJpY2VzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgc2F2ZUN1cnJlbmN5UHJpY2VzKCkge1xuICAgICAgICB0aGlzLnNlY3VyZVN0b3JhZ2Uuc2V0U3luYyh7XG4gICAgICAgICAgICBrZXk6IFwiY3J5cHRvQ29pbkNhbGNQcmljZUluZm9ybWF0aW9uRGF0YVwiLFxuICAgICAgICAgICAgdmFsdWU6IEpTT04uc3RyaW5naWZ5KHRoaXMuY3VycmVuY3lQcmljZXMpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGxvYWRDdXJyZW5jeVByaWNlcygpIHtcbiAgICAgICAgbGV0IHN0b3JlZFByaWNlSW5mb3JtYXRpb25TdHJpbmcgPSB0aGlzLnNlY3VyZVN0b3JhZ2UuZ2V0U3luYyh7XG4gICAgICAgICAgICBrZXk6IFwiY3J5cHRvQ29pbkNhbGNQcmljZUluZm9ybWF0aW9uRGF0YVwiLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoc3RvcmVkUHJpY2VJbmZvcm1hdGlvblN0cmluZykge1xuICAgICAgICAgICAgbGV0IHN0b3JlZFByaWNlSW5mb3JtYXRpb25zID0gSlNPTi5wYXJzZShzdG9yZWRQcmljZUluZm9ybWF0aW9uU3RyaW5nKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdG9yZWRQcmljZUluZm9ybWF0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBzdG9yZWRQcmljZUluZm9ybWF0aW9uID0gc3RvcmVkUHJpY2VJbmZvcm1hdGlvbnNbaV07XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUN1cnJlbmN5UHJpY2Uoc3RvcmVkUHJpY2VJbmZvcm1hdGlvbi5jdXJyZW5jeUNvZGVGcm9tLFxuICAgICAgICAgICAgICAgICAgICBzdG9yZWRQcmljZUluZm9ybWF0aW9uLmN1cnJlbmN5Q29kZVRvLFxuICAgICAgICAgICAgICAgICAgICBzdG9yZWRQcmljZUluZm9ybWF0aW9uLmN1cnJlbmN5UHJpY2VEZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVkUHJpY2VJbmZvcm1hdGlvbi5wbGF0Zm9ybSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iXX0=